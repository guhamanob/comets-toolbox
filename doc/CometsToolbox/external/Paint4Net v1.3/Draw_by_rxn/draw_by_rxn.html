<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of draw_by_rxn</title>
  <meta name="keywords" content="draw_by_rxn">
  <meta name="description" content="draw_by_rxn.m">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>

<!-- # CometsToolbox -->
<!-- ../../menu.html external -->
<!-- # Paint4Net v1.3 -->
<!-- menu.html Draw_by_rxn -->
<h1>draw_by_rxn

</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>draw_by_rxn.m</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function [involvedMets,deadEnds,deadRxns]=draw_by_rxn(model,rxns,drawMap,direction,initialMet,excludeMets,flux,save,closev) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> draw_by_rxn.m
 Script of the Paint4Net to declare the scope of visualization by a list of
 reactions.

 function [involvedMets,deadEnds,deadRxns]=draw_by_rxn(model,rxns,drawMap,direction,initialMet,excludeMets,flux,save,closev)

 INPUT

 model - COBRA Toolbox model
 rxns - a list of reactions in the COBRA model in the form
       {'Rxn_Abbr_1','Rxn_Abbr_2',...,'Rxn_Abbr_n'} or cell type vector from the
       MATLAB workcpase.

 OPTIONAL INPUT

 drawMap - a boolean type variable that can take value of true or false
       (default is false) indicating whether to visualize the COBRA model or not.
       The main idea of this argument is to ensure possibility to save
       time by not visualizing a large COBRA model and get a result faster.
 direction - a string type variable that can take value of 'struc', 'sub',
       'prod' or 'both' (default is 'struc') indicating a direction for the
       algorithm. In case of 'struc' (structure) the algorithm visualizes all
       metabolites connected to the specified reactions in the argument rxns.
       The key feature of this function is visualization of all specified reactions
       not taking in account a steady state fluxes in that way representing the
       structure of the COBRA model. In case of 'sub' (substrates) the algorithm
       visualizes only those metabolites which are substrates for the specified 
       reactions in the argument rxns. This time the algorithm is using a stoichiometric 
       matrix and the steady state fluxes to determine direction of each reaction. 
       The algorithm is using an assumption that only those fluxes which rates
       are smaller than -10-9 mmol*g-1*h-1 or greater than +10-9 mmol*g-1*h-1 
       are non-zero fluxes. In case of 'prod' (products) the algorithm visualizes 
       only those metabolites which are products for the specified reactions in 
       the argument rxns but in case of 'both' the algorithm visualizes both
       – substrates and products - for the specified reactions in the argument
       rxns. For both cases the algorithm is using the same rules regarding to 
       calculation of the directions for each reaction as for case of 'sub'.
       This argument is essential for the command draw_by_met of the Paint4Net v1.0
       because the command draw_by_met is calling out the command draw_by_rxn
       and passing the argument direction.
 initialMet - a cell type variable that can take a value that represents
       the abbreviation of a metabolite in the COBRA model (default is
       empty). This metabolite is represented as green ellipse on the map
       and this feature is essential for the command draw_by_met because 
       the command draw_by_met is calling out the command draw_by_rxn and 
       passing the argument initialMet.
 excludeMets - a list of metabolites (default is empty) that will be excluded
       from the visualization map of the COBRA model in form of the abbreviations
       of the metabolites separated by a comma
       {'Met_Abbr_1','Met_Abbr_2',...,'Met_Abbr_n'} or a cell type vector 
       in the MATLAB workspace that contains the static abbreviations of the
       metabolites. The main idea of this argument is to ensure possibility 
       to exclude very employed metabolites (e.g., h, h2o, atp, adp, nad etc.)
       to avoid unnecessary mesh on the map.
 flux - a double type Nx1 size vector of fluxes of reactions where N is number 
       of reactions (default is vector of x). This vector is calculated during
       the optimization of the objective function. Use the command
       optimizeCbModel.m.
 save - a boolean type variable that can take value of true or false
       (default is false) indicating whether to automatically save visualization as jpeg file or not.
       This is usefull for iterative function call with different
       input arguments for visualization scope.
 closev - a boolean type variable that can take value of true or false
       (default is false) indicating whether to close the biograph viewer
       window or not after the visualization. This is usefull for iterative
       function call with different input arguments for visualization
       scope.

 OUTPUT

 involvedMets - a cell type vector that contains a list of the involved metabolites
       in the specified reactions. 
 deadEnds - a cell type vector that contains a list of the dead end
       metabolites in the specified reactions.
 deadRxns - a cell type vector that contains a list of the dead reactions
        in the specified visualization scope.

 Andrejs Kostromins 03/10/2012 E-mail: andrejs.kostromins@gmail.com</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">

<li><a href="../../../../CometsToolbox/external/m2html/@template/get.html" class="code" title="function varargout = get(tpl,action,varargin)">get</a>	TEMPLATE/GET Access data stored in a Template object</li>
<li><a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>	TEMPLATE/SET Edit data stored in a Template object</li>
</ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">

<li><a href="../../../../CometsToolbox/external/Paint4Net v1.3/Draw_by_met/draw_by_met.html" class="code" title="function [involvedRxns,involvedMets,deadEnds,deadRxns]=draw_by_met(model,metAbbr,drawMap,radius,direction,excludeMets,flux,save,closev)">draw_by_met</a>	draw_by_met.m</li>
<li><a href="../../../../CometsToolbox/util/drawByRxn.html" class="code" title="function [involvedMets,DeadEnds] = drawByRxn(varargin)">drawByRxn</a>	DRAWBYRXN A wrapper for the draw_by_rxn function from Paint4Net, to</li>
</ul>
<!-- crossreference -->




<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% draw_by_rxn.m</span>
0002 <span class="comment">% Script of the Paint4Net to declare the scope of visualization by a list of</span>
0003 <span class="comment">% reactions.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% function [involvedMets,deadEnds,deadRxns]=draw_by_rxn(model,rxns,drawMap,direction,initialMet,excludeMets,flux,save,closev)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% INPUT</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% model - COBRA Toolbox model</span>
0010 <span class="comment">% rxns - a list of reactions in the COBRA model in the form</span>
0011 <span class="comment">%       {'Rxn_Abbr_1','Rxn_Abbr_2',...,'Rxn_Abbr_n'} or cell type vector from the</span>
0012 <span class="comment">%       MATLAB workcpase.</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% OPTIONAL INPUT</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% drawMap - a boolean type variable that can take value of true or false</span>
0017 <span class="comment">%       (default is false) indicating whether to visualize the COBRA model or not.</span>
0018 <span class="comment">%       The main idea of this argument is to ensure possibility to save</span>
0019 <span class="comment">%       time by not visualizing a large COBRA model and get a result faster.</span>
0020 <span class="comment">% direction - a string type variable that can take value of 'struc', 'sub',</span>
0021 <span class="comment">%       'prod' or 'both' (default is 'struc') indicating a direction for the</span>
0022 <span class="comment">%       algorithm. In case of 'struc' (structure) the algorithm visualizes all</span>
0023 <span class="comment">%       metabolites connected to the specified reactions in the argument rxns.</span>
0024 <span class="comment">%       The key feature of this function is visualization of all specified reactions</span>
0025 <span class="comment">%       not taking in account a steady state fluxes in that way representing the</span>
0026 <span class="comment">%       structure of the COBRA model. In case of 'sub' (substrates) the algorithm</span>
0027 <span class="comment">%       visualizes only those metabolites which are substrates for the specified</span>
0028 <span class="comment">%       reactions in the argument rxns. This time the algorithm is using a stoichiometric</span>
0029 <span class="comment">%       matrix and the steady state fluxes to determine direction of each reaction.</span>
0030 <span class="comment">%       The algorithm is using an assumption that only those fluxes which rates</span>
0031 <span class="comment">%       are smaller than -10-9 mmol*g-1*h-1 or greater than +10-9 mmol*g-1*h-1</span>
0032 <span class="comment">%       are non-zero fluxes. In case of 'prod' (products) the algorithm visualizes</span>
0033 <span class="comment">%       only those metabolites which are products for the specified reactions in</span>
0034 <span class="comment">%       the argument rxns but in case of 'both' the algorithm visualizes both</span>
0035 <span class="comment">%       – substrates and products - for the specified reactions in the argument</span>
0036 <span class="comment">%       rxns. For both cases the algorithm is using the same rules regarding to</span>
0037 <span class="comment">%       calculation of the directions for each reaction as for case of 'sub'.</span>
0038 <span class="comment">%       This argument is essential for the command draw_by_met of the Paint4Net v1.0</span>
0039 <span class="comment">%       because the command draw_by_met is calling out the command draw_by_rxn</span>
0040 <span class="comment">%       and passing the argument direction.</span>
0041 <span class="comment">% initialMet - a cell type variable that can take a value that represents</span>
0042 <span class="comment">%       the abbreviation of a metabolite in the COBRA model (default is</span>
0043 <span class="comment">%       empty). This metabolite is represented as green ellipse on the map</span>
0044 <span class="comment">%       and this feature is essential for the command draw_by_met because</span>
0045 <span class="comment">%       the command draw_by_met is calling out the command draw_by_rxn and</span>
0046 <span class="comment">%       passing the argument initialMet.</span>
0047 <span class="comment">% excludeMets - a list of metabolites (default is empty) that will be excluded</span>
0048 <span class="comment">%       from the visualization map of the COBRA model in form of the abbreviations</span>
0049 <span class="comment">%       of the metabolites separated by a comma</span>
0050 <span class="comment">%       {'Met_Abbr_1','Met_Abbr_2',...,'Met_Abbr_n'} or a cell type vector</span>
0051 <span class="comment">%       in the MATLAB workspace that contains the static abbreviations of the</span>
0052 <span class="comment">%       metabolites. The main idea of this argument is to ensure possibility</span>
0053 <span class="comment">%       to exclude very employed metabolites (e.g., h, h2o, atp, adp, nad etc.)</span>
0054 <span class="comment">%       to avoid unnecessary mesh on the map.</span>
0055 <span class="comment">% flux - a double type Nx1 size vector of fluxes of reactions where N is number</span>
0056 <span class="comment">%       of reactions (default is vector of x). This vector is calculated during</span>
0057 <span class="comment">%       the optimization of the objective function. Use the command</span>
0058 <span class="comment">%       optimizeCbModel.m.</span>
0059 <span class="comment">% save - a boolean type variable that can take value of true or false</span>
0060 <span class="comment">%       (default is false) indicating whether to automatically save visualization as jpeg file or not.</span>
0061 <span class="comment">%       This is usefull for iterative function call with different</span>
0062 <span class="comment">%       input arguments for visualization scope.</span>
0063 <span class="comment">% closev - a boolean type variable that can take value of true or false</span>
0064 <span class="comment">%       (default is false) indicating whether to close the biograph viewer</span>
0065 <span class="comment">%       window or not after the visualization. This is usefull for iterative</span>
0066 <span class="comment">%       function call with different input arguments for visualization</span>
0067 <span class="comment">%       scope.</span>
0068 <span class="comment">%</span>
0069 <span class="comment">% OUTPUT</span>
0070 <span class="comment">%</span>
0071 <span class="comment">% involvedMets - a cell type vector that contains a list of the involved metabolites</span>
0072 <span class="comment">%       in the specified reactions.</span>
0073 <span class="comment">% deadEnds - a cell type vector that contains a list of the dead end</span>
0074 <span class="comment">%       metabolites in the specified reactions.</span>
0075 <span class="comment">% deadRxns - a cell type vector that contains a list of the dead reactions</span>
0076 <span class="comment">%        in the specified visualization scope.</span>
0077 <span class="comment">%</span>
0078 <span class="comment">% Andrejs Kostromins 03/10/2012 E-mail: andrejs.kostromins@gmail.com</span>
0079 
0080 <a name="_sub0" href="#_subfunctions" class="code">function [involvedMets,deadEnds,deadRxns]=draw_by_rxn(model,rxns,drawMap,direction,initialMet,excludeMets,flux,save,closev)</a>
0081 
0082   <span class="keyword">if</span> nargin&lt;7 <span class="comment">%if the number of arguments &lt; 7, fill flux vector with x</span>
0083         <span class="keyword">for</span> v=1:length(model.rxns)
0084             flux(v)=<span class="string">'x'</span>;
0085         <span class="keyword">end</span>
0086   <span class="keyword">end</span>
0087     
0088   <span class="keyword">if</span> nargin&lt;8 <span class="comment">%if the number of arguments &lt; 8, save=false</span>
0089         save=false;
0090     <span class="keyword">end</span>
0091     <span class="keyword">if</span> nargin&lt;9
0092         closev=false; <span class="comment">%if the number of arguments &lt; 9, closev=false</span>
0093     <span class="keyword">end</span>
0094 
0095 <span class="keyword">if</span> ~isempty(flux) <span class="comment">%if flux vector is not empty</span>
0096     Start_time2=clock;
0097     Start_time=clock;
0098          
0099     <span class="comment">%print start time for task</span>
0100     Start_time=strcat(num2str(Start_time(1)),<span class="string">'_'</span>,num2str(Start_time(2)),<span class="string">'_'</span>,num2str(Start_time(3)),<span class="string">'_'</span>,num2str(Start_time(4)),<span class="string">'_'</span>,num2str(Start_time(5)),<span class="string">'_'</span>,num2str(Start_time(6)))
0101    
0102     <span class="keyword">if</span> nargin&lt;3 <span class="comment">%if the number of arguments &lt; 3, drawMap=false</span>
0103         drawMap=false;
0104     <span class="keyword">end</span>  
0105 
0106     <span class="keyword">if</span> nargin&lt;4 <span class="comment">%if the number of arguments &lt; 4, direction='struc'</span>
0107         direction=<span class="string">'struc'</span>;
0108     <span class="keyword">end</span>
0109 
0110     <span class="keyword">if</span> nargin&lt;6 <span class="comment">%if the number of arguments &lt; 6, excludeMets{1}=''</span>
0111         excludeMets{1}=<span class="string">''</span>;
0112     <span class="keyword">end</span>
0113 
0114     <span class="comment">%declares variables</span>
0115     not_present_rxns{1}=<span class="string">'0'</span>;
0116     rxns_index=1;
0117 
0118     <span class="keyword">for</span> i=1:length(rxns) <span class="comment">%cycle through the list of reactions</span>
0119         
0120         exist=false;
0121         
0122         <span class="keyword">for</span> j=1:length(model.rxns) <span class="comment">%cycle through the reactions in the model</span>
0123             
0124             <span class="keyword">if</span> strcmp(model.rxns{j},rxns{i}) <span class="comment">%if particular reaction exists in the model</span>
0125                j=length(model.rxns); 
0126                exist=true;
0127             <span class="keyword">end</span>
0128 
0129             <span class="keyword">if</span> j==length(model.rxns) &amp;&amp; exist~=true <span class="comment">% if partucular reaction does not exist in the model, add to the list of not present reactions</span>
0130                not_present_rxns{rxns_index}=rxns{i};
0131                rxns_index=rxns_index+1;
0132             <span class="keyword">end</span>
0133             
0134         <span class="keyword">end</span>
0135         
0136     <span class="keyword">end</span>
0137 
0138     <span class="keyword">if</span> not_present_rxns{1}==<span class="string">'0'</span>; <span class="comment">%if all reactions were present in the model</span>
0139 
0140         RxIDs=findRxnIDs(model,rxns); <span class="comment">%find reaction IDs in the model</span>
0141         
0142         <span class="comment">%declare variables</span>
0143         involvedMets=<span class="string">''</span>;
0144         mets_index=1;    
0145 
0146         <span class="keyword">for</span> y=1:length(model.mets) <span class="comment">%cycle through the metabolites in the model</span>
0147             
0148             <span class="keyword">for</span> x=1:length(RxIDs) <span class="comment">%cycle through the reaction IDs</span>
0149                 
0150                 <span class="keyword">switch</span> direction <span class="comment">%check the value of the variable direction</span>
0151                     
0152                     <span class="keyword">case</span> <span class="string">'sub'</span> <span class="comment">%in cace of direction = 'sub'</span>
0153                          
0154                         <span class="keyword">if</span> model.S(y,RxIDs(x))&lt;0 &amp;&amp; flux(RxIDs(x))&gt;1e-9 || model.S(y,RxIDs(x))&gt;0 &amp;&amp; flux(RxIDs(x))&lt;-1e-9 <span class="comment">%if the metabolite in the S matrix has negative coefficient, but the flux is positive or the opposite</span>
0155                             
0156                             <span class="keyword">if</span> ~strcmp(excludeMets{1},<span class="string">''</span>) <span class="comment">%if the list of excludable metabolites is not empty</span>
0157                                 
0158                                 exclude=false;
0159                                 
0160                                 <span class="keyword">for</span> v=1:length(excludeMets) <span class="comment">%cycle through the metabolites in the list of excludable metabolites</span>
0161                                     
0162                                     <span class="keyword">if</span> strcmp(excludeMets{v},model.mets{y}) <span class="comment">%if particular metabolite exists in the list of excludable metabolites</span>
0163                                         exclude=true;
0164                                         <span class="keyword">break</span>;
0165                                     <span class="keyword">end</span>
0166                                     
0167                                 <span class="keyword">end</span>
0168                                 
0169                                 <span class="keyword">if</span> exclude==false <span class="comment">%if must not be excluded from visualization, add to the list of involved metabolites</span>
0170                                     involvedMets{mets_index,1}=model.mets{y};
0171                                     mets_index=mets_index+1;    
0172                                 <span class="keyword">end</span>
0173                                 
0174                             <span class="keyword">else</span> <span class="comment">%if the list of excludable metabolites is empty, add to the list of involved metabolites</span>
0175                                 
0176                                 involvedMets{mets_index,1}=model.mets{y};
0177                                 mets_index=mets_index+1;
0178                                 
0179                             <span class="keyword">end</span>
0180                             <span class="keyword">break</span>;
0181                             
0182                         <span class="keyword">end</span>
0183                         
0184                     <span class="keyword">case</span> <span class="string">'prod'</span> <span class="comment">%in cace of direction = 'prod'</span>
0185                         
0186                         <span class="keyword">if</span> model.S(y,RxIDs(x))&gt;0 &amp;&amp; flux(RxIDs(x))&gt;1e-9 || model.S(y,RxIDs(x))&lt;0 &amp;&amp; flux(RxIDs(x))&lt;-1e-9 <span class="comment">%if the metabolite in the S matrix has positive coefficient and the flux is positive or the opposite</span>
0187                             
0188                             <span class="keyword">if</span> ~strcmp(excludeMets{1},<span class="string">''</span>) <span class="comment">%if the list of excludable metabolites is not empty</span>
0189                                 
0190                                 exclude=false;
0191                                 
0192                                 <span class="keyword">for</span> v=1:length(excludeMets) <span class="comment">%cycle through the metabolites in the list of excludable metabolites</span>
0193                                     
0194                                     <span class="keyword">if</span> strcmp(excludeMets{v},model.mets{y}) <span class="comment">%if particular metabolite exists in the list of excludable metabolites</span>
0195                                         exclude=true;
0196                                         <span class="keyword">break</span>;
0197                                     <span class="keyword">end</span>
0198                                     
0199                                 <span class="keyword">end</span>
0200                                 
0201                                 <span class="keyword">if</span> exclude==false <span class="comment">%if must not be excluded from visualization, add to the list of involved metabolites</span>
0202                                     involvedMets{mets_index,1}=model.mets{y};
0203                                     mets_index=mets_index+1;    
0204                                 <span class="keyword">end</span>
0205                                 
0206                             <span class="keyword">else</span> <span class="comment">%if the list of excludable metabolites is empty, add to the list of involved metabolites</span>
0207                                 
0208                                 involvedMets{mets_index,1}=model.mets{y};
0209                                 mets_index=mets_index+1;
0210                                 
0211                             <span class="keyword">end</span>                
0212                             <span class="keyword">break</span>;
0213                             
0214                         <span class="keyword">end</span>
0215                         
0216                     <span class="keyword">case</span> <span class="string">'struc'</span> <span class="comment">%in cace of direction = 'struc'</span>
0217                         
0218                         <span class="keyword">if</span> model.S(y,RxIDs(x))&lt;0 || model.S(y,RxIDs(x))&gt;0 <span class="comment">%if the metabolite in the S matrix has negative or possitive coefficient</span>
0219                             
0220                             <span class="keyword">if</span> ~strcmp(excludeMets{1},<span class="string">''</span>) <span class="comment">%if the list of excludable metabolites is not empty</span>
0221                                 
0222                                 exclude=false;
0223                                 
0224                                 <span class="keyword">for</span> v=1:length(excludeMets) <span class="comment">%cycle through the metabolites in the list of excludable metabolites</span>
0225                                     
0226                                     <span class="keyword">if</span> strcmp(excludeMets{v},model.mets{y}) <span class="comment">%if particular metabolite exists in the list of excludable metabolites</span>
0227                                         exclude=true;
0228                                         <span class="keyword">break</span>;
0229                                     <span class="keyword">end</span>
0230                                     
0231                                 <span class="keyword">end</span>
0232                                 
0233                                 <span class="keyword">if</span> exclude==false <span class="comment">%if must not be excluded from visualization, add to the list of involved metabolites</span>
0234                                     involvedMets{mets_index,1}=model.mets{y};
0235                                     mets_index=mets_index+1;    
0236                                 <span class="keyword">end</span>
0237                                 
0238                             <span class="keyword">else</span> <span class="comment">%if the list of excludable metabolites is empty, add to the list of involved metabolites</span>
0239                                 
0240                                 involvedMets{mets_index,1}=model.mets{y};
0241                                 mets_index=mets_index+1;
0242                                 
0243                             <span class="keyword">end</span>                
0244                             <span class="keyword">break</span>;
0245                             
0246                         <span class="keyword">end</span>
0247                     <span class="keyword">case</span> <span class="string">'both'</span> <span class="comment">%in cace of direction = 'both'</span>
0248                         <span class="comment">%if (the metabolite in the S matrix has negative coefficient, but the flux is positive or the opposite) or (the metabolite in the S matrix has positive coefficient and the flux is positive or the opposite)</span>
0249                         <span class="keyword">if</span> model.S(y,RxIDs(x))&lt;0 &amp;&amp; flux(RxIDs(x))&gt;1e-9 || model.S(y,RxIDs(x))&gt;0 &amp;&amp; flux(RxIDs(x))&lt;-1e-9 || model.S(y,RxIDs(x))&gt;0 || model.S(y,RxIDs(x))&gt;0 &amp;&amp; flux(RxIDs(x))&gt;1e-9 || model.S(y,RxIDs(x))&lt;0 &amp;&amp; flux(RxIDs(x))&lt;-1e-9
0250                             
0251                             <span class="keyword">if</span> ~strcmp(excludeMets{1},<span class="string">''</span>) <span class="comment">%if the list of excludable metabolites is not empty</span>
0252                                 
0253                                 exclude=false;
0254                                 
0255                                 <span class="keyword">for</span> v=1:length(excludeMets) <span class="comment">%cycle through the metabolites in the list of excludable metabolites</span>
0256                                     
0257                                     <span class="keyword">if</span> strcmp(excludeMets{v},model.mets{y}) <span class="comment">%if particular metabolite exists in the list of excludable metabolites</span>
0258                                         exclude=true;
0259                                         <span class="keyword">break</span>;
0260                                     <span class="keyword">end</span>
0261                                     
0262                                 <span class="keyword">end</span>
0263                                 
0264                                 <span class="keyword">if</span> exclude==false <span class="comment">%if must not be excluded from visualization, add to the list of involved metabolites</span>
0265                                     involvedMets{mets_index,1}=model.mets{y};
0266                                     mets_index=mets_index+1;    
0267                                 <span class="keyword">end</span>
0268                                 
0269                             <span class="keyword">else</span> <span class="comment">%if the list of excludable metabolites is empty, add to the list of involved metabolites</span>
0270                                 
0271                                 involvedMets{mets_index,1}=model.mets{y};
0272                                 mets_index=mets_index+1;
0273                                 
0274                             <span class="keyword">end</span>                
0275                             <span class="keyword">break</span>;
0276                             
0277                         <span class="keyword">end</span>
0278                         
0279                 <span class="keyword">end</span>
0280                 
0281             <span class="keyword">end</span>
0282             
0283         <span class="keyword">end</span>
0284        
0285         <span class="keyword">if</span> nargin&gt;5 &amp;&amp; ~strcmp(initialMet{1},<span class="string">''</span>) <span class="comment">%if the number of arguments &gt; 5 and the argument initialMet is not empty</span>
0286             
0287             <span class="keyword">if</span> ~ismember(initialMet{1},involvedMets) <span class="comment">%if initialMet is not already in the list of involved metabolites, add initalMet to the list of involved metabolotes</span>
0288                 involvedMets{length(involvedMets)+1,1}=initialMet{1};
0289             <span class="keyword">end</span> 
0290             
0291         <span class="keyword">end</span>
0292 
0293         MetIDs=findMetIDs(model,involvedMets); <span class="comment">%find metabolite IDs in the model</span>
0294     
0295         <span class="keyword">for</span> x=1:length(RxIDs) <span class="comment">%cycle through the reaction IDs</span>
0296             
0297             <span class="keyword">for</span> y=1:length(MetIDs) <span class="comment">%cycle through the metabolite IDs</span>
0298                 
0299                 <span class="keyword">if</span> model.S(MetIDs(y),RxIDs(x))==0 || model.ub(RxIDs(x))==0&amp;&amp;model.lb(RxIDs(x))==0<span class="comment">%if the metabolite in the S matrix has coefficient=0 and botj bounds =0, add zeros into conectivity matrix</span>
0300                     matrix(y,x+length(MetIDs))=0;
0301                     matrix(x+length(MetIDs),y)=0;                    
0302                 <span class="keyword">elseif</span> model.S(MetIDs(y),RxIDs(x))&lt;0 &amp;&amp; flux(RxIDs(x))&gt;1e-9 <span class="comment">%if the metabolite in the S matrix has negative coefficient, but the flux is positive, add native direction entry into conectivity matrix</span>
0303                     matrix(y,x+length(MetIDs))=1;
0304                     matrix(x+length(MetIDs),y)=0;                    
0305                 <span class="keyword">elseif</span> model.S(MetIDs(y),RxIDs(x))&lt;0 &amp;&amp; flux(RxIDs(x))&lt;-1e-9 <span class="comment">%if the metabolite in the S matrix has negative coefficient and the flux is negative, add not-native direction entry into conectivity matrix</span>
0306                     matrix(y,x+length(MetIDs))=0;
0307                     matrix(x+length(MetIDs),y)=1;                    
0308                 <span class="keyword">elseif</span> model.S(MetIDs(y),RxIDs(x))&gt;0 &amp;&amp; flux(RxIDs(x))&gt;1e-9 <span class="comment">%if the metabolite in the S matrix has positive coefficient and the flux is positive, add native direction entry into conectivity matrix</span>
0309                     matrix(length(MetIDs)+x,y)=1;
0310                     matrix(y,length(MetIDs)+x)=0;                    
0311                 <span class="keyword">elseif</span> model.S(MetIDs(y),RxIDs(x))&gt;0 &amp;&amp; flux(RxIDs(x))&lt;-1e-9 <span class="comment">%if the metabolite in the S matrix has positive coefficient, but the flux is negative, add not-native direction entry into conectivity matrix</span>
0312                     matrix(length(MetIDs)+x,y)=0;
0313                     matrix(y,length(MetIDs)+x)=1;                     
0314                 <span class="keyword">elseif</span> model.S(MetIDs(y),RxIDs(x))&lt;0 &amp;&amp; model.ub(RxIDs(x))&gt;1e-9<span class="comment">%if there is no flux and the metabolite in the S matrix has negative coefficient, and u.bound &gt;0, add native direction entry into conectivity matrix</span>
0315                     matrix(y,x+length(MetIDs))=1;
0316                     matrix(x+length(MetIDs),y)=0;
0317                 <span class="keyword">elseif</span> model.S(MetIDs(y),RxIDs(x))&lt;0 &amp;&amp; model.ub(RxIDs(x))==0&amp;&amp; model.lb(RxIDs(x))&lt;-1e-9<span class="comment">%if there is no flux and the metabolite in the S matrix has negative coefficient, and u.bound=0, but l.bound&lt;0, add non-native direction entry into conectivity matrix</span>
0318                     matrix(length(MetIDs)+x,y)=1;
0319                     matrix(y,length(MetIDs)+x)=0;
0320                 <span class="keyword">elseif</span> model.S(MetIDs(y),RxIDs(x))&gt;0 &amp;&amp; model.ub(RxIDs(x))&gt;1e-9<span class="comment">%if there is no flux and the metabolite in the S matrix has positive coefficient, and u.bound &gt;0, add native direction entry into conectivity matrix</span>
0321                     matrix(length(MetIDs)+x,y)=1;
0322                     matrix(y,length(MetIDs)+x)=0;  
0323                 <span class="keyword">elseif</span> model.S(MetIDs(y),RxIDs(x))&gt;0 &amp;&amp; model.ub(RxIDs(x))==0&amp;&amp; model.lb(RxIDs(x))&lt;-1e-9<span class="comment">%if there is no flux and the metabolite in the S matrix has positive coefficient, and u.bound=0, but l.bound&lt;0, add non-native direction entry into conectivity matrix</span>
0324                     matrix(y,x+length(MetIDs))=1;
0325                     matrix(x+length(MetIDs),y)=0;
0326                 <span class="keyword">end</span>
0327                 
0328             <span class="keyword">end</span>
0329             
0330         <span class="keyword">end</span>
0331 
0332         <span class="comment">%declare variables</span>
0333         MetsNodesIDs=[1:length(MetIDs)];
0334         DeadMetsID(1)=-1;
0335         
0336         <span class="keyword">for</span> v=1:length(MetsNodesIDs) <span class="comment">%cycle through the metabolite node IDs</span>
0337             
0338             <span class="keyword">if</span> sum(matrix(v,:)) + sum(matrix(:,v))&lt;2 <span class="comment">%if the sum in the conectivity matrix &lt; 2 (0 or 1 incoming/outgoing arrow), add to the list of dead end metabolites</span>
0339                 
0340                 <span class="keyword">if</span> DeadMetsID(1)==-1
0341                     DeadMetsID(1)=v;
0342                     deadEnds{1,1}=involvedMets{v,1};
0343                 <span class="keyword">else</span>
0344                     DeadMetsID(length(DeadMetsID)+1)=v;
0345                     deadEnds{length(deadEnds)+1,1}=involvedMets{v,1};
0346                 <span class="keyword">end</span>
0347                 
0348             <span class="comment">%if the sum in the conectivity matrix &gt; 1 (at least 2 incoming and 0 outgoing arrows or at least 2 outgoing and 0 incoming arrows) it could be dead end metabolite</span>
0349             <span class="keyword">elseif</span> sum(matrix(v,:)) + sum(matrix(:,v))&gt;1 &amp;&amp; sum(matrix(v,:))&gt;0 &amp;&amp; sum(matrix(:,v))==0 || sum(matrix(v,:)) + sum(matrix(:,v))&gt;1 &amp;&amp; sum(matrix(v,:))==0 &amp;&amp; sum(matrix(:,v))&gt;0
0350                 
0351                 DeadMet=true;            
0352                 
0353                 <span class="keyword">for</span> w=length(MetsNodesIDs)+1:length(matrix) <span class="comment">%cycle through the conectivity matrix starting from the first reaction index</span>
0354                     
0355                     <span class="keyword">if</span> matrix(v,w)==1 &amp;&amp;model.lb(RxIDs(w-length(MetsNodesIDs)))&lt;-1e-9&amp;&amp;model.ub(RxIDs(w-length(MetsNodesIDs)))&gt;1e-9 <span class="comment">%if the coefficient in the conectivity matrix = 1 and this reaction in the model is reversible, then it is not a dead end metabolite</span>
0356                         DeadMet=false;
0357                         <span class="keyword">break</span>;
0358                     <span class="keyword">end</span>
0359                     
0360                 <span class="keyword">end</span>
0361 
0362                 <span class="keyword">if</span> DeadMet==true
0363                     
0364                     <span class="keyword">for</span> w=length(MetsNodesIDs)+1:length(matrix) <span class="comment">%cycle through the conectivity matrix starting from the first reaction index</span>
0365                         
0366                         <span class="keyword">if</span> matrix(w,v)==1 &amp;&amp; model.lb(RxIDs(w-length(MetsNodesIDs)))&lt;-1e-9&amp;&amp;model.ub(RxIDs(w-length(MetsNodesIDs)))&gt;1e-9  <span class="comment">%if the coefficient in the conectivity matrix = 1 and this reaction in the model is reversible, then it is not a dead end metabolite</span>
0367                             DeadMet=false;
0368                             <span class="keyword">break</span>;
0369                         <span class="keyword">end</span>
0370                         
0371                     <span class="keyword">end</span>
0372 
0373                     <span class="keyword">if</span> DeadMet==true <span class="comment">%if still dead end, add to the list of dead end metabolites</span>
0374                         
0375                         <span class="keyword">if</span> DeadMetsID(1)==-1
0376                                DeadMetsID(1)=v;
0377                                deadEnds{1,1}=involvedMets{v,1};
0378                         <span class="keyword">else</span>
0379                                DeadMetsID(length(DeadMetsID)+1)=v;
0380                                deadEnds{length(deadEnds)+1,1}=involvedMets{v,1};
0381                         <span class="keyword">end</span>
0382                         
0383                     <span class="keyword">end</span>
0384                     
0385                 <span class="keyword">end</span>  
0386                 
0387             <span class="keyword">end</span>
0388             
0389         <span class="keyword">end</span>   
0390 
0391         <span class="keyword">if</span> DeadMetsID(1)==-1 <span class="comment">%if no dead ends</span>
0392             deadEnds=<span class="string">'No dead ends'</span>;
0393         <span class="keyword">end</span>
0394         
0395         DeadRxnsID(1)=-1;<span class="comment">%declare variable</span>
0396         DeadRxnsID2(1)={<span class="string">'-1'</span>};<span class="comment">%declare variable</span>
0397         
0398         <span class="comment">%performe FVA</span>
0399         [minFlux,maxFlux] = fluxVariability(model,100,<span class="string">'max'</span>,rxns);
0400         
0401         <span class="keyword">for</span> v=1:length(minFlux)
0402             <span class="keyword">if</span> minFlux(v)&lt;1e-9&amp;maxFlux(v)==minFlux(v)&amp;minFlux(v)&gt;-1e-9
0403                  <span class="keyword">if</span> strcmp(DeadRxnsID2(1),<span class="string">'-1'</span>)
0404                      DeadRxnsID2(1)=rxns(v);                                          
0405                  <span class="keyword">else</span>
0406                       DeadRxnsID2(length(DeadRxnsID2)+1)=rxns(v);                                              
0407                 <span class="keyword">end</span>
0408             <span class="keyword">end</span>
0409         <span class="keyword">end</span>     
0410         
0411         deadRxns=DeadRxnsID2';  <span class="comment">%return list of dead reactions</span>
0412 
0413         <span class="keyword">if</span> strcmp(drawMap,<span class="string">'true'</span>) <span class="comment">%if drawMap=true</span>
0414             
0415             ids=involvedMets;
0416 
0417             <span class="keyword">if</span> nargin&gt;5 &amp;&amp; ~strcmp(initialMet{1},<span class="string">''</span>) <span class="comment">%if the number of arguments &gt; 5 and the argument initialMet is not empty</span>
0418                 
0419                 <span class="keyword">for</span> v=1:length(ids) <span class="comment">%cycle through the node ids</span>
0420                     
0421                     <span class="keyword">if</span> strcmp(initialMet,ids{v})
0422                         initialMetID=v; <span class="comment">%get the initial met ID</span>
0423                     <span class="keyword">end</span>
0424                     
0425                 <span class="keyword">end</span>
0426                 
0427             <span class="keyword">end</span>
0428 
0429             <span class="keyword">for</span> v=1:length(RxIDs) <span class="comment">%cycle through the reaction ids</span>
0430                 ids{length(ids)+1}=strcat(model.rxns{RxIDs(v)},<span class="string">' ('</span>,num2str(flux(RxIDs(v))),<span class="string">')'</span>); <span class="comment">%node id=reaction abbr+flux rate</span>
0431                 RxnsNodesIDs(v)=length(ids); <span class="comment">%get all reaction nodes IDs</span>
0432             <span class="keyword">end</span>
0433 
0434             ids=ids';      
0435 
0436             map = biograph(matrix,ids,<span class="string">'ShowTextInNodes'</span>,<span class="string">'ID'</span>,<span class="string">'LayoutType'</span>, <span class="string">'hierarchical'</span>) <span class="comment">%create a biograph object EdgeType/ 'LayoutType', 'evuilibrium'</span>
0437             
0438             <span class="keyword">for</span> m=1:length(involvedMets) <span class="comment">%cycle through the involved mets</span>
0439                 
0440                 <span class="keyword">for</span> n=1:length(model.mets) <span class="comment">%cycle through the mets in the model</span>
0441                     
0442                     <span class="keyword">if</span> strcmp(involvedMets{m},model.mets{n}) <span class="comment">%if particular metabolite has been found in the model</span>
0443                         
0444                         <span class="keyword">try</span> <span class="comment">%try to set label=metabolite name</span>
0445                             <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(map.nodes(m), <span class="string">'Label'</span>, strcat(<span class="string">'Name: '</span>,model.metNames{n}))                           
0446                         <span class="keyword">catch</span> info
0447                         <span class="keyword">end</span>
0448                         
0449                         <span class="keyword">try</span> <span class="comment">%try to set description=metabolite charged formula</span>
0450                             <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(map.nodes(m), <span class="string">'Description'</span>, strcat(<span class="string">'Charged formula: '</span>,model.metFormulas{n}))
0451                         <span class="keyword">catch</span> info
0452                         <span class="keyword">end</span>
0453                         
0454                     <span class="keyword">end</span>
0455                     
0456                 <span class="keyword">end</span>
0457                 
0458             <span class="keyword">end</span>
0459             
0460             <span class="keyword">for</span> m=1:length(RxIDs) <span class="comment">%cycle through the reaction IDs</span>
0461                 
0462                 <span class="keyword">for</span> n=1:length(model.rxns) <span class="comment">%cycle through the reactions in the model</span>
0463                     
0464                     <span class="keyword">if</span> strcmp(model.rxns{RxIDs(m)},model.rxns{n}) <span class="comment">%if particular reaction has been found in the model</span>
0465                         
0466                         <span class="keyword">try</span> <span class="comment">%try to set label=reaction name</span>
0467                             <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(map.nodes(length(involvedMets)+m), <span class="string">'Label'</span>, strcat(<span class="string">'Name: '</span>,model.rxnNames{n}))
0468                         <span class="keyword">catch</span> info
0469                         <span class="keyword">end</span>
0470                         
0471                         <span class="keyword">try</span> <span class="comment">%try to set description=reaction evuation</span>
0472                             strtmp=printRxnFormula(model,model.rxns{RxIDs(m)},false);                    
0473                             <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(map.nodes(length(involvedMets)+m), <span class="string">'Description'</span>, strcat(<span class="string">'Reaction: '</span>,strtmp{1},<span class="string">' lb='</span>,num2str(model.lb(RxIDs(m))),<span class="string">' ub='</span>,num2str(model.ub(RxIDs(m)))))
0474                         <span class="keyword">catch</span> info
0475                         <span class="keyword">end</span>
0476                         
0477                     <span class="keyword">end</span>
0478                     
0479                 <span class="keyword">end</span>
0480                 
0481             <span class="keyword">end</span>
0482     
0483             max_flux=max(abs(flux)); <span class="comment">%get max absolute flux value from the input vector</span>
0484 
0485             <span class="keyword">for</span> p=length(MetsNodesIDs)+1:length(ids) <span class="comment">%cycle through the nodes IDs starting from the first reaction node</span>
0486                 
0487                 <span class="keyword">if</span> flux(RxIDs(p-length(MetsNodesIDs)))&gt;1e-9 &amp;&amp; flux(RxIDs(p-length(MetsNodesIDs)))~=<span class="string">'x'</span> <span class="comment">%if flux is positive and not evual to x</span>
0488                     edges1 = getedgesbynodeid(map,ids(p),[]); <span class="comment">%get all source edges connected to particular reaction node</span>
0489                     edges2 = getedgesbynodeid(map,[],ids(p)); <span class="comment">%get all sink edges connected to particular reaction node</span>
0490                     tot_edges=[edges1;edges2]; <span class="comment">%concatenate edges</span>
0491                     <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(tot_edges,<span class="string">'LineColor'</span>,[0 1 0]); <span class="comment">%set green color to found edges</span>
0492                     <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(tot_edges,<span class="string">'LineWidth'</span>,abs(7*(flux(RxIDs(p-length(MetsNodesIDs))))/max_flux)); <span class="comment">%set thichness of edge proportional to max flux</span>
0493                 <span class="keyword">elseif</span> flux(RxIDs(p-length(MetsNodesIDs)))&lt;-1e-9 &amp;&amp; flux(RxIDs(p-length(MetsNodesIDs)))~=<span class="string">'x'</span> <span class="comment">%if flux is negative and not evual to x</span>
0494                     edges1 = getedgesbynodeid(map,ids(p),[]); <span class="comment">%get all source edges connected to particular reaction node</span>
0495                     edges2 = getedgesbynodeid(map,[],ids(p)); <span class="comment">%get all sink edges connected to particular reaction node</span>
0496                     tot_edges=[edges1;edges2]; <span class="comment">%concatenate edges</span>
0497                     <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(tot_edges,<span class="string">'LineColor'</span>,[0 0 1]); <span class="comment">%set green color to found edges</span>
0498                     <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(tot_edges,<span class="string">'LineWidth'</span>,abs(7*(flux(RxIDs(p-length(MetsNodesIDs))))/max_flux)); <span class="comment">%set thichness of edge proportional to max flux</span>
0499                 <span class="keyword">end</span>
0500             <span class="keyword">end</span>  
0501             
0502             
0503                h=view(map); <span class="comment">%generate layout</span>
0504                <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(h.nodes(RxnsNodesIDs),<span class="string">'Color'</span>,[241/255,176/255,102/255]); <span class="comment">%set color to reaction nodes</span>
0505                <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(h.nodes(MetsNodesIDs),<span class="string">'Shape'</span>,<span class="string">'ellipse'</span>); <span class="comment">%set shape of ellipse to metabolite nodes</span>
0506                                      
0507                   
0508              <span class="keyword">for</span> v=1:length(DeadRxnsID2)
0509                  <span class="keyword">for</span> z=length(involvedMets)+1:length(ids)
0510                     tmpR=[];
0511                     <span class="keyword">for</span> q=1:length(ids{z})
0512                         <span class="keyword">if</span> ~strcmp(ids{z}(q),<span class="string">' '</span>)
0513                             tmpR=[tmpR ids{z}(q)];
0514                         <span class="keyword">else</span>
0515                             <span class="keyword">break</span>
0516                         <span class="keyword">end</span>
0517                     <span class="keyword">end</span>
0518                       <span class="keyword">if</span> strcmp(DeadRxnsID2{v},tmpR)
0519                              <span class="keyword">if</span> DeadRxnsID(1)==-1
0520                                  DeadRxnsID(1)=z;     
0521                                  <span class="keyword">break</span>
0522                              <span class="keyword">else</span>
0523                                   DeadRxnsID(length(DeadRxnsID)+1)=z;     
0524                                   <span class="keyword">break</span>
0525                              <span class="keyword">end</span>
0526                       <span class="keyword">end</span>
0527                 <span class="keyword">end</span>
0528              <span class="keyword">end</span>   
0529 
0530             <span class="keyword">if</span> DeadMetsID(1)~=-1 <span class="comment">%if dead end mets exist</span>
0531                 <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(h.nodes(DeadMetsID),<span class="string">'Color'</span>,[1 0 0]); <span class="comment">%set red color to dead end metabolite nodes</span>
0532             <span class="keyword">end</span>           
0533             
0534             ExRxnsID=-1;<span class="comment">%declare variable</span>
0535             
0536             <span class="keyword">for</span> q=length(MetsNodesIDs)+1:size(matrix,2) <span class="comment">%cycle through the nodes IDs starting from the first reaction node</span>
0537                 
0538                 <span class="keyword">if</span> sum(matrix(q,:)) + sum(matrix(:,q))&lt;2 <span class="comment">%if sum of edges to one reactio node is less then 2, then it could be exchange reaction</span>
0539                     
0540                     <span class="keyword">if</span> ExRxnsID(1)==-1
0541                         ExRxnsID(1)=q;
0542                     <span class="keyword">else</span>
0543                         ExRxnsID(length(ExRxnsID)+1)=q;
0544                     <span class="keyword">end</span>
0545                     
0546                 <span class="keyword">end</span>
0547                 
0548             <span class="keyword">end</span>
0549             
0550             <span class="keyword">if</span> ExRxnsID(1)~=-1 <span class="comment">%if exchange reactions exist</span>
0551                 <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(h.nodes(ExRxnsID),<span class="string">'Color'</span>,[173/255, 1, 47/255]); <span class="comment">%set red color to exchange reaction nodes</span>
0552             <span class="keyword">end</span>
0553    
0554             <span class="keyword">if</span> nargin&gt;5 &amp;&amp; ~strcmp(initialMet{1},<span class="string">''</span>) <span class="comment">%if the number of arguments &gt; 5 and the argument initialMet is not empty</span>
0555                 <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(h.nodes(initialMetID),<span class="string">'Color'</span>,[0 1 0]); <span class="comment">%set green color to initial met node</span>
0556             <span class="keyword">end</span>            
0557         
0558             <span class="keyword">if</span> DeadRxnsID(1)~=-1 <span class="comment">%if dead reactions exist</span>
0559                 <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(h.nodes(DeadRxnsID),<span class="string">'Color'</span>,[1 0 0]); <span class="comment">%set red color to dead reaction nodes</span>
0560             <span class="keyword">end</span>
0561             
0562             <span class="keyword">if</span> ExRxnsID(1)~=-1 <span class="comment">%if exchange reactions exist</span>
0563                 <a href="../../../../CometsToolbox/external/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(h.nodes(ExRxnsID),<span class="string">'Shape'</span>,<span class="string">'diamond'</span>); <span class="comment">%set shape of ellipse to metabolite nodes</span>
0564             <span class="keyword">end</span>
0565             
0566             <span class="keyword">if</span> strcmp(save,<span class="string">'true'</span>) <span class="comment">%if save=true</span>
0567                 f = <a href="../../../../CometsToolbox/external/m2html/@template/get.html" class="code" title="function varargout = get(tpl,action,varargin)">get</a>(h.hgAxes, <span class="string">'Parent'</span>);
0568                 clock_tmp=clock;        
0569                 print(f, <span class="string">'-djpeg'</span>, strcat(num2str(clock_tmp(1)),<span class="string">'_'</span>,num2str(clock_tmp(2)),<span class="string">'_'</span>,num2str(clock_tmp(3)),<span class="string">'_'</span>,num2str(clock_tmp(4)),<span class="string">'_'</span>,num2str(clock_tmp(5)),<span class="string">'_'</span>,num2str(clock_tmp(6)),<span class="string">'.jpg'</span>));
0570         
0571             <span class="keyword">end</span>
0572             
0573             <span class="keyword">if</span> strcmp(closev,<span class="string">'true'</span>) <span class="comment">%if closev=true</span>
0574                 child_handles = allchild(0);
0575                 names = <a href="../../../../CometsToolbox/external/m2html/@template/get.html" class="code" title="function varargout = get(tpl,action,varargin)">get</a>(child_handles,<span class="string">'Name'</span>);
0576                 k = find(strncmp(<span class="string">'Biograph Viewer'</span>, names, 15));
0577                 close(child_handles(k))
0578             <span class="keyword">end</span>
0579             
0580         <span class="keyword">end</span>   
0581 
0582     <span class="keyword">else</span> <span class="comment">%if in the input list was at least one unexisting reaction in the model</span>
0583         
0584         disp(<span class="string">'The following reactions are not present in the model:'</span>)
0585         not_present=not_present_rxns'
0586         involvedMets=<span class="string">'No involved mets'</span>;
0587         deadEnds=<span class="string">'No dead ends'</span>;
0588         
0589     <span class="keyword">end</span>
0590     
0591     <span class="comment">%print end and total time for task</span>
0592     End_time=clock;
0593          Total_time=End_time-Start_time2;
0594          End_time=strcat(num2str(End_time(1)),<span class="string">'_'</span>,num2str(End_time(2)),<span class="string">'_'</span>,num2str(End_time(3)),<span class="string">'_'</span>,num2str(End_time(4)),<span class="string">'_'</span>,num2str(End_time(5)),<span class="string">'_'</span>,num2str(End_time(6)))
0595         Total_time=strcat(num2str(Total_time(1)),<span class="string">'_'</span>,num2str(Total_time(2)),<span class="string">'_'</span>,num2str(Total_time(3)),<span class="string">'_'</span>,num2str(Total_time(4)),<span class="string">'_'</span>,num2str(Total_time(5)),<span class="string">'_'</span>,num2str(Total_time(6)))
0596 <span class="keyword">else</span> <span class="comment">%if flux vector is empty</span>
0597     
0598         disp(<span class="string">'The flux vector is empty'</span>)
0599         involvedMets=<span class="string">'No involved mets'</span>;
0600         deadEnds=<span class="string">'No dead ends'</span>;
0601         End_time=clock;
0602          Total_time=End_time-Start_time2;
0603          End_time=strcat(num2str(End_time(1)),<span class="string">'_'</span>,num2str(End_time(2)),<span class="string">'_'</span>,num2str(End_time(3)),<span class="string">'_'</span>,num2str(End_time(4)),<span class="string">'_'</span>,num2str(End_time(5)),<span class="string">'_'</span>,num2str(End_time(6)))
0604         Total_time=strcat(num2str(Total_time(1)),<span class="string">'_'</span>,num2str(Total_time(2)),<span class="string">'_'</span>,num2str(Total_time(3)),<span class="string">'_'</span>,num2str(Total_time(4)),<span class="string">'_'</span>,num2str(Total_time(5)),<span class="string">'_'</span>,num2str(Total_time(6)))
0605         
0606 <span class="keyword">end</span>
0607 <span class="keyword">end</span></pre></div>

<hr><address>Generated on Tue 24-Jan-2017 14:13:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>