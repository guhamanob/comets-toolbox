<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of draw_by_met</title>
  <meta name="keywords" content="draw_by_met">
  <meta name="description" content="draw_by_met.m">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>

<!-- # CometsToolbox -->
<!-- ../../menu.html external -->
<!-- # Paint4Net v1.3 -->
<!-- menu.html Draw_by_met -->
<h1>draw_by_met

</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>draw_by_met.m</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function [involvedRxns,involvedMets,deadEnds,deadRxns]=draw_by_met(model,metAbbr,drawMap,radius,direction,excludeMets,flux,save,closev) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> draw_by_met.m
 Script of the Paint4Net to define the scope of visualization by a
 metabolite

 function [involvedRxns,involvedMets,deadEnds,deadRxns]=draw_by_met(model,metAbbr,drawMap,radius,direction,excludeMets,flux,save,closev)

 INPUT

 model - COBRA Toolbox model
 metAbbr - a cell type variable that can take a value that represents the
       abbreviation of a metabolite in the COBRA model. This metabolite is
       the start point for visualization. 

 OPTIONAL INPUT

 drawMap - a logical type variable that can take value of true or false
       (default is false) indicating whether to visualize the COBRA model or not.
       The main idea of this argument is to ensure possibility to save
       time by not visualizing a large COBRA model and get a result faster.
 radius - a double type variable that can take a value of natural numbers
       (1,2,3…n). The argument radius indicates the depth of an analysis
       of the initial metabolite (the argument metAbbr) and it is tightly 
       connected to the optional argument direction. For example, if user 
       is interested in the substrates of ethanol, the user can analyse substrates
       step by step starting from the first reactions where the argument radius 
       is equal to 1 and moving to the next reactions by increasing the value 
       of the argument radius.
 direction - a string type variable that can take value of 'struc', 'sub',
       'prod' or 'both' (default is 'struc') indicating a direction for the
       algorithm. In case of 'struc' (structure) the algorithm visualizes all
       metabolites connected to the specified reactions in the argument rxns.
       The key feature of this function is visualization of all specified reactions
       not taking in account a steady state fluxes in that way representing the
       structure of the COBRA model. In case of 'sub' (substrates) the algorithm
       visualizes only those metabolites which are substrates for the specified 
       reactions in the argument rxns. This time the algorithm is using a stoichiometric 
       matrix and the steady state fluxes to determine direction of each reaction. 
       The algorithm is using an assumption that only those fluxes which rates
       are smaller than -10-9 mmol*g-1*h-1 or greater than +10-9 mmol*g-1*h-1 
       are non-zero fluxes. In case of 'prod' (products) the algorithm visualizes 
       only those metabolites which are products for the specified reactions in 
       the argument rxns but in case of 'both' the algorithm visualizes both
       – substrates and products - for the specified reactions in the argument
       rxns. For both cases the algorithm is using the same rules regarding to 
       calculation of the directions for each reaction as for case of 'sub'.
       This argument is essential for the command draw_by_met of the Paint4Net v1.0
       because the command draw_by_met is calling out the command draw_by_rxn
       and passing the argument direction.
 excludeMets - a list of metabolites (default is empty) that will be excluded
       from the visualization map of the COBRA model in form of the abbreviations
       of the metabolites separated by a comma
       {'Met_Abbr_1','Met_Abbr_2',...,'Met_Abbr_n'} or a cell type vector 
       in the MATLAB workspace that contains the static abbreviations of the
       metabolites. The main idea of this argument is to ensure possibility 
       to exclude very employed metabolites (e.g., h, h2o, atp, adp, nad etc.)
       to avoid unnecessary mesh on the map.
 flux - a double type Nx1 size vector of fluxes of reactions where N is number 
       of reactions (default is vector of x). This vector is calculated during
       the optimization of the objective function. Use the command
       optimizeCbModel.m.
 save - a boolean type variable that can take value of true or false
       (default is false) indicating whether to automatically save visualization as jpeg file or not.
       This is usefull for iterative function call with different
       input arguments for visualization scope.
 closev - a boolean type variable that can take value of true or false
       (default is false) indicating whether to close the biograph viewer
       window or not after the visualization. This is usefull for iterative
       function call with different input arguments for visualization
       scope.

 OUTPUT

 involvedRxns - a cell type vector that contains a list of the involved
       reactions according to the set of input arguments.
 involvedMets - a cell type vector that contains a list of the involved metabolites
       in the specified reactions.
 deadEnds - a cell type vector that contains a list of the dead end
       metabolites in the specified reactions.

 Andrejs Kostromins 04/10/2012 E-mail: andrejs.kostromins@gmail.com</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">

<li><a href="findNearRxns.html" class="code" title="function Rxns=findNearRxns(model,Rxns,direction,flux)">findNearRxns</a>	findNearRxns.m</li>
<li><a href="../../../../CometsToolbox/external/Paint4Net v1.3/Draw_by_rxn/draw_by_rxn.html" class="code" title="function [involvedMets,deadEnds,deadRxns]=draw_by_rxn(model,rxns,drawMap,direction,initialMet,excludeMets,flux,save,closev)">draw_by_rxn</a>	draw_by_rxn.m</li>
</ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">

<li><a href="../../../../CometsToolbox/util/drawByMet.html" class="code" title="function [involvedRxns,involvedMets,DeadEnds] = drawByMet(varargin)">drawByMet</a>	DRAWBYMET(model, met, [rad], [solution]) Visualize the reaction dynamics</li>
</ul>
<!-- crossreference -->




<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% draw_by_met.m</span>
0002 <span class="comment">% Script of the Paint4Net to define the scope of visualization by a</span>
0003 <span class="comment">% metabolite</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% function [involvedRxns,involvedMets,deadEnds,deadRxns]=draw_by_met(model,metAbbr,drawMap,radius,direction,excludeMets,flux,save,closev)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% INPUT</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% model - COBRA Toolbox model</span>
0010 <span class="comment">% metAbbr - a cell type variable that can take a value that represents the</span>
0011 <span class="comment">%       abbreviation of a metabolite in the COBRA model. This metabolite is</span>
0012 <span class="comment">%       the start point for visualization.</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% OPTIONAL INPUT</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% drawMap - a logical type variable that can take value of true or false</span>
0017 <span class="comment">%       (default is false) indicating whether to visualize the COBRA model or not.</span>
0018 <span class="comment">%       The main idea of this argument is to ensure possibility to save</span>
0019 <span class="comment">%       time by not visualizing a large COBRA model and get a result faster.</span>
0020 <span class="comment">% radius - a double type variable that can take a value of natural numbers</span>
0021 <span class="comment">%       (1,2,3…n). The argument radius indicates the depth of an analysis</span>
0022 <span class="comment">%       of the initial metabolite (the argument metAbbr) and it is tightly</span>
0023 <span class="comment">%       connected to the optional argument direction. For example, if user</span>
0024 <span class="comment">%       is interested in the substrates of ethanol, the user can analyse substrates</span>
0025 <span class="comment">%       step by step starting from the first reactions where the argument radius</span>
0026 <span class="comment">%       is equal to 1 and moving to the next reactions by increasing the value</span>
0027 <span class="comment">%       of the argument radius.</span>
0028 <span class="comment">% direction - a string type variable that can take value of 'struc', 'sub',</span>
0029 <span class="comment">%       'prod' or 'both' (default is 'struc') indicating a direction for the</span>
0030 <span class="comment">%       algorithm. In case of 'struc' (structure) the algorithm visualizes all</span>
0031 <span class="comment">%       metabolites connected to the specified reactions in the argument rxns.</span>
0032 <span class="comment">%       The key feature of this function is visualization of all specified reactions</span>
0033 <span class="comment">%       not taking in account a steady state fluxes in that way representing the</span>
0034 <span class="comment">%       structure of the COBRA model. In case of 'sub' (substrates) the algorithm</span>
0035 <span class="comment">%       visualizes only those metabolites which are substrates for the specified</span>
0036 <span class="comment">%       reactions in the argument rxns. This time the algorithm is using a stoichiometric</span>
0037 <span class="comment">%       matrix and the steady state fluxes to determine direction of each reaction.</span>
0038 <span class="comment">%       The algorithm is using an assumption that only those fluxes which rates</span>
0039 <span class="comment">%       are smaller than -10-9 mmol*g-1*h-1 or greater than +10-9 mmol*g-1*h-1</span>
0040 <span class="comment">%       are non-zero fluxes. In case of 'prod' (products) the algorithm visualizes</span>
0041 <span class="comment">%       only those metabolites which are products for the specified reactions in</span>
0042 <span class="comment">%       the argument rxns but in case of 'both' the algorithm visualizes both</span>
0043 <span class="comment">%       – substrates and products - for the specified reactions in the argument</span>
0044 <span class="comment">%       rxns. For both cases the algorithm is using the same rules regarding to</span>
0045 <span class="comment">%       calculation of the directions for each reaction as for case of 'sub'.</span>
0046 <span class="comment">%       This argument is essential for the command draw_by_met of the Paint4Net v1.0</span>
0047 <span class="comment">%       because the command draw_by_met is calling out the command draw_by_rxn</span>
0048 <span class="comment">%       and passing the argument direction.</span>
0049 <span class="comment">% excludeMets - a list of metabolites (default is empty) that will be excluded</span>
0050 <span class="comment">%       from the visualization map of the COBRA model in form of the abbreviations</span>
0051 <span class="comment">%       of the metabolites separated by a comma</span>
0052 <span class="comment">%       {'Met_Abbr_1','Met_Abbr_2',...,'Met_Abbr_n'} or a cell type vector</span>
0053 <span class="comment">%       in the MATLAB workspace that contains the static abbreviations of the</span>
0054 <span class="comment">%       metabolites. The main idea of this argument is to ensure possibility</span>
0055 <span class="comment">%       to exclude very employed metabolites (e.g., h, h2o, atp, adp, nad etc.)</span>
0056 <span class="comment">%       to avoid unnecessary mesh on the map.</span>
0057 <span class="comment">% flux - a double type Nx1 size vector of fluxes of reactions where N is number</span>
0058 <span class="comment">%       of reactions (default is vector of x). This vector is calculated during</span>
0059 <span class="comment">%       the optimization of the objective function. Use the command</span>
0060 <span class="comment">%       optimizeCbModel.m.</span>
0061 <span class="comment">% save - a boolean type variable that can take value of true or false</span>
0062 <span class="comment">%       (default is false) indicating whether to automatically save visualization as jpeg file or not.</span>
0063 <span class="comment">%       This is usefull for iterative function call with different</span>
0064 <span class="comment">%       input arguments for visualization scope.</span>
0065 <span class="comment">% closev - a boolean type variable that can take value of true or false</span>
0066 <span class="comment">%       (default is false) indicating whether to close the biograph viewer</span>
0067 <span class="comment">%       window or not after the visualization. This is usefull for iterative</span>
0068 <span class="comment">%       function call with different input arguments for visualization</span>
0069 <span class="comment">%       scope.</span>
0070 <span class="comment">%</span>
0071 <span class="comment">% OUTPUT</span>
0072 <span class="comment">%</span>
0073 <span class="comment">% involvedRxns - a cell type vector that contains a list of the involved</span>
0074 <span class="comment">%       reactions according to the set of input arguments.</span>
0075 <span class="comment">% involvedMets - a cell type vector that contains a list of the involved metabolites</span>
0076 <span class="comment">%       in the specified reactions.</span>
0077 <span class="comment">% deadEnds - a cell type vector that contains a list of the dead end</span>
0078 <span class="comment">%       metabolites in the specified reactions.</span>
0079 <span class="comment">%</span>
0080 <span class="comment">% Andrejs Kostromins 04/10/2012 E-mail: andrejs.kostromins@gmail.com</span>
0081 
0082 <a name="_sub0" href="#_subfunctions" class="code">function [involvedRxns,involvedMets,deadEnds,deadRxns]=draw_by_met(model,metAbbr,drawMap,radius,direction,excludeMets,flux,save,closev)</a>
0083 
0084 <span class="keyword">if</span> nargin&lt;3 <span class="comment">%if the number of arguments &lt; 3, drawMap=false</span>
0085    drawMap=false;
0086 <span class="keyword">end</span>
0087 
0088 <span class="keyword">if</span> nargin&lt;4 <span class="comment">%if the number of arguments &lt; 4, radius=1</span>
0089     radius=1;
0090 <span class="keyword">end</span>
0091 
0092 <span class="keyword">if</span> nargin&lt;7 <span class="comment">%if the number of arguments &lt; 7, fill flux vector with x</span>
0093     <span class="keyword">for</span> q=1:length(model.rxns)
0094           flux(q)=<span class="string">'x'</span>;
0095     <span class="keyword">end</span>
0096 <span class="keyword">end</span>
0097 
0098 <span class="keyword">if</span> nargin&lt;8 <span class="comment">%if the number of arguments &lt; 8, save=false</span>
0099     save=false;
0100 <span class="keyword">end</span>
0101 
0102 <span class="keyword">if</span> nargin&lt;9 <span class="comment">%if the number of arguments &lt; 8, closev=false</span>
0103     closev=false;
0104 <span class="keyword">end</span>
0105     
0106 <span class="keyword">if</span> radius&gt;0 <span class="comment">%if radius &gt; 0</span>
0107 
0108     <span class="keyword">if</span> ~isempty(flux) <span class="comment">%if flux vector is not empty</span>
0109 
0110         <span class="keyword">if</span> nargin&lt;5 <span class="comment">%if the number of arguments &lt; 5, direction='struc'</span>
0111             direction=<span class="string">'struc'</span>;
0112         <span class="keyword">end</span>
0113 
0114         <span class="keyword">if</span> nargin&lt;6 <span class="comment">%if the number of arguments &lt; 6, excludeMets{1}=''</span>
0115             excludeMets{1}=<span class="string">''</span>;
0116         <span class="keyword">end</span>            
0117         
0118         Rxns=findRxnsFromMets(model,metAbbr); <span class="comment">%find reactions around the initial metabolite</span>
0119 
0120         <span class="keyword">if</span> length(Rxns)~=0 <span class="comment">%if the list is not empty</span>
0121             
0122             RxnsID=findRxnIDs(model,Rxns); <span class="comment">%find reaction IDs in the model</span>
0123             metID=findMetIDs(model,metAbbr); <span class="comment">%find initial metabolite ID in the model</span>
0124             involvedRxns{1}=<span class="string">'No rxns'</span>; <span class="comment">%declare variable</span>
0125             
0126             <span class="keyword">for</span> q=1:length(RxnsID) <span class="comment">%cycle through the reaction IDs</span>
0127                 
0128                 <span class="keyword">switch</span> direction <span class="comment">%check the value of the variable direction</span>
0129                     
0130                     <span class="keyword">case</span> <span class="string">'sub'</span> <span class="comment">%in cace of direction = 'sub'</span>
0131                         
0132                         <span class="comment">%if (the reaction in the S matrix has negative coefficient and the flux is negative or the opposite) and the flux is not equal to x, add to involved reactions</span>
0133                         <span class="keyword">if</span> (model.S(metID,RxnsID(q))&lt;0 &amp;&amp; flux(RxnsID(q))&lt;-1e-9 || model.S(metID,RxnsID(q))&gt;0 &amp;&amp; flux(RxnsID(q))&gt;1e-9)&amp;&amp;flux(RxnsID(q))~=<span class="string">'x'</span>
0134                             
0135                            <span class="keyword">if</span> strcmp(involvedRxns{1},<span class="string">'No rxns'</span>)
0136                               involvedRxns{1,1}=Rxns{q};            
0137                            <span class="keyword">else</span>
0138                               involvedRxns{length(involvedRxns)+1,1}=Rxns{q};
0139                            <span class="keyword">end</span>
0140                            
0141                         <span class="keyword">end</span>
0142                         
0143                     <span class="keyword">case</span> <span class="string">'prod'</span> <span class="comment">%in cace of direction = 'prod'</span>
0144                         
0145                         <span class="comment">%if (the reaction in the S matrix has positive coefficient, but the flux is negative or the opposite) and the flux is not equal to x, add to involved reactions</span>
0146                         <span class="keyword">if</span> (model.S(metID,RxnsID(q))&gt;0 &amp;&amp; flux(RxnsID(q))&lt;-1e-9 || model.S(metID,RxnsID(q))&lt;0 &amp;&amp; flux(RxnsID(q))&gt;1e-9) &amp;&amp; flux(RxnsID(q))~=<span class="string">'x'</span>
0147                             
0148                            <span class="keyword">if</span> strcmp(involvedRxns{1},<span class="string">'No rxns'</span>)
0149                               involvedRxns{1,1}=Rxns{q};            
0150                            <span class="keyword">else</span>
0151                               involvedRxns{length(involvedRxns)+1,1}=Rxns{q};
0152                            <span class="keyword">end</span>
0153                            
0154                         <span class="keyword">end</span>
0155                         
0156                     <span class="keyword">case</span> <span class="string">'both'</span> <span class="comment">%in cace of direction = 'both'</span>
0157                         
0158                         <span class="comment">%if (the reaction in the S matrix has nonzero coefficient and the flux is negative or positive) and the flux is not equal to x, add to involved reactions</span>
0159                         <span class="keyword">if</span> (model.S(metID,RxnsID(q))~=0 &amp;&amp; (flux(RxnsID(q))&lt;-1e-9 || flux(RxnsID(q))&gt;1e-9))&amp;&amp;flux(RxnsID(q))~=<span class="string">'x'</span>
0160                             
0161                            <span class="keyword">if</span> strcmp(involvedRxns{1},<span class="string">'No rxns'</span>)
0162                               involvedRxns{1,1}=Rxns{q};            
0163                            <span class="keyword">else</span>
0164                               involvedRxns{length(involvedRxns)+1,1}=Rxns{q};
0165                            <span class="keyword">end</span>
0166                            
0167                         <span class="keyword">end</span>
0168                         
0169                     <span class="keyword">case</span> <span class="string">'struc'</span> <span class="comment">%in cace of direction = 'struc'</span>
0170                         
0171                         <span class="keyword">if</span> model.S(metID,RxnsID(q))~=0 <span class="comment">%if the reaction in the S matrix has nonzero coefficient, add to involved reactions</span>
0172                             
0173                            <span class="keyword">if</span> strcmp(involvedRxns{1},<span class="string">'No rxns'</span>)
0174                               involvedRxns{1,1}=Rxns{q};            
0175                            <span class="keyword">else</span>
0176                               involvedRxns{length(involvedRxns)+1,1}=Rxns{q};
0177                            <span class="keyword">end</span>
0178                            
0179                         <span class="keyword">end</span>
0180                         
0181                 <span class="keyword">end</span>
0182                 
0183             <span class="keyword">end</span>
0184 
0185             <span class="keyword">if</span> ~strcmp(involvedRxns{1},<span class="string">'No rxns'</span>) <span class="comment">%if the list of involved reactions is not empty</span>
0186                 
0187                 <span class="keyword">for</span> q=1:radius-1 <span class="comment">%cycle through the radius-1</span>
0188                     involvedRxns=<a href="findNearRxns.html" class="code" title="function Rxns=findNearRxns(model,Rxns,direction,flux)">findNearRxns</a>(model,involvedRxns,direction,flux);
0189                 <span class="keyword">end</span>  
0190 
0191                 [involvedMets,deadEnds,deadRxns]=<a href="../../../../CometsToolbox/external/Paint4Net v1.3/Draw_by_rxn/draw_by_rxn.html" class="code" title="function [involvedMets,deadEnds,deadRxns]=draw_by_rxn(model,rxns,drawMap,direction,initialMet,excludeMets,flux,save,closev)">draw_by_rxn</a>(model,involvedRxns,drawMap,direction,metAbbr,excludeMets,flux,save,closev); <span class="comment">%call out the command draw_by_rxn with obtained arguments</span>
0192                 
0193             <span class="keyword">else</span> <span class="comment">%if the list of involved reactions is empty</span>
0194                 
0195                 <span class="keyword">switch</span> direction <span class="comment">%check the value of the variable direction</span>
0196                     
0197                     <span class="keyword">case</span> <span class="string">'sub'</span> <span class="comment">%in cace of direction = 'sub'</span>
0198                         disp([<span class="string">'According to given fluxes no substrates were found for metabolite '</span>,metAbbr{1}])                    
0199                     <span class="keyword">case</span> <span class="string">'prod'</span> <span class="comment">%in cace of direction = 'prod'</span>
0200                         disp([<span class="string">'According to given fluxes no products were found for metabolite '</span>,metAbbr{1}])
0201                     <span class="keyword">case</span> <span class="string">'both'</span> <span class="comment">%in cace of direction = 'both'</span>
0202                         disp([<span class="string">'According to given fluxes no substrates and products were found for metabolite '</span>,metAbbr{1}])                
0203                 <span class="keyword">end</span>            
0204                 
0205                 <span class="comment">%declare variables</span>
0206                 deadEnds=<span class="string">'No dead ends'</span>;
0207                 involvedRxns=<span class="string">'No rxns'</span>;
0208                 involvedMets=<span class="string">'No mets'</span>;
0209                 
0210             <span class="keyword">end</span>          
0211 
0212         <span class="keyword">else</span> <span class="comment">%if the initial metabolite is not present in the model</span>
0213             
0214             disp(strcat(metAbbr,<span class="string">' is not present in the model'</span>))
0215             deadEnds=<span class="string">'No dead ends'</span>;
0216             involvedRxns=<span class="string">'No rxns'</span>;
0217             involvedMets=<span class="string">'No mets'</span>;
0218             
0219         <span class="keyword">end</span>
0220         
0221     <span class="keyword">else</span> <span class="comment">%if flux vector is empty</span>
0222         
0223         disp(<span class="string">'The flux vector is empty'</span>)
0224         deadEnds=<span class="string">'No dead ends'</span>;
0225         involvedRxns=<span class="string">'No rxns'</span>;
0226         involvedMets=<span class="string">'No mets'</span>;
0227         
0228     <span class="keyword">end</span>
0229     
0230 <span class="keyword">else</span> <span class="comment">%if radius is not &gt; 0</span>
0231     
0232     disp(<span class="string">'The value of the argument RADIUS must be a natural number, for example, 1,2,3...n'</span>)
0233     deadEnds=<span class="string">'No dead ends'</span>;
0234     involvedRxns=<span class="string">'No rxns'</span>;
0235     involvedMets=<span class="string">'No mets'</span>;
0236     
0237 <span class="keyword">end</span></pre></div>

<hr><address>Generated on Wed 01-Feb-2017 15:53:14 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>